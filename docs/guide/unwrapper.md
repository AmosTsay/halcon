# 解包裹（Unwrapping）原理

> 因为**相位值**![2-8](./images/2-8.png)是通过由**反正切函数**计算得到的，而反正切函数在开区间x∈(-π,π)之间，相位值是被包裹在该区间中的，所以称该相位值为wrap phase 

## wrap phase
> wrap phase的图像是成锯齿状而且不连续分布，我们的目的是得到连续的相位，所以还需要对wrap phase进行**phase unwrapping**。

wrap phase是一个二维的矩阵，我们需要先从一维入手将其展开，计算的公式如下：
![](./images/2-12.png)（2-7）
- 在2-7式中，左边的![](./images/2-13.png)表示是k点展开之后的相位信息，
- 右边的![](./images/2-13.png)代表的是k点的包裹相位信息，而![](./images/2-14.png)则表示的是k点在包裹相位的相位级次信息。
-  次级的![](./images/2-14.png)信息一般采用邻域查找法[1]，即比较![](./images/2-14.png)与![](./images/2-15.png)之间像素的相位差
- 如果该相位差的值大于pi，则次级的值减去1；反之，若相位差的值小于-pi，则该次级的值加1。

设k点相位次级为![](./images/2-14.png)，k+1点的相位次级为![](./images/2-15.png)，它们之间有如下的关系：

![](./images/2-16.png)（2-8）

## 二维计算

因为一张图片，其实是一个二维矩阵，所以一维展开后，同样也对二维进行展开计算，这样就可以得到wrap phase的矩阵。

## 最后

至此我们已经得到了所有的未知量，只要将已知量和未知量都代入计算，并可以求得物体的高度信息。

## 误差分析

但是由于相机的畸变等硬件方面的误差，还有各个部件摆放位置不够精确等因素，可能会导致最后得到的结果误差较大，所以我们还需要对相机进行标定，来形成一个较为准确而真实的高度分布的结果。

